<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>TRUST TAP ‚Ä¢ ADMIN</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #1e1e2f; color: #fff; padding: 20px; }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .status { padding: 5px 10px; background: #4caf50; border-radius: 5px; font-size: 14px; }
        table { width: 100%; border-collapse: collapse; background: #2a2a40; box-shadow: 0 4px 6px rgba(0,0,0,0.3); border-radius: 8px; overflow: hidden; }
        th, td { padding: 15px; text-align: left; border-bottom: 1px solid #3f3f5a; }
        th { background-color: #3b82f6; color: white; font-weight: 600; }
        tr:hover { background-color: #32324e; }
        .money { color: #4ade80; font-weight: bold; }
        .energy { color: #facc15; }
    </style>
</head>
<body>
    <div class="header">
        <h2>üë• –ü–∞–Ω–µ–ª—å –∫–µ—Ä—É–≤–∞–Ω–Ω—è TRUST TAP</h2>
        <div class="status" id="updateStatus">–û–Ω–æ–≤–ª–µ–Ω–æ —â–æ–π–Ω–æ</div>
    </div>
    
    <table>
        <thead>
            <tr>
                <th>Telegram ID</th>
                <th>Username</th>
                <th>–ë–∞–ª–∞–Ω—Å (USDT)</th>
                <th>–ï–Ω–µ—Ä–≥—ñ—è</th>
                <th>–†–µ—Ñ–µ—Ä–∞–ª–∏</th>
                <th>–û—Å—Ç–∞–Ω–Ω—è –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å</th>
            </tr>
        </thead>
        <tbody id="usersTable">
            <tr><td colspan="6">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö...</td></tr>
        </tbody>
    </table>

    <script>
        // –¢–≤–æ—î –Ω–æ–≤–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä Render
        const API_URL = 'https://click-9pdn.onrender.com/api/admin/users'; 

        function fetchUsers() {
            document.getElementById('updateStatus').textContent = '–û–Ω–æ–≤–ª—é—é...';
            
            fetch(API_URL)
                .then(res => res.json())
                .then(users => {
                    const tbody = document.getElementById('usersTable');
                    tbody.innerHTML = ''; 
                    
                    users.forEach(u => {
                        const date = new Date(u.lastSync);
                        const now = new Date();
                        const diffSec = Math.floor((now - date) / 1000);
                        
                        // –Ø–∫—â–æ –≥—Ä–∞–≤–µ—Ü—å —Ç–∞–ø–∞–≤ –º–µ–Ω—à–µ 30 —Å–µ–∫—É–Ω–¥ —Ç–æ–º—É ‚Äî –≤—ñ–Ω –æ–Ω–ª–∞–π–Ω
                        const timeText = diffSec < 30 ? '<span style="color:#4ade80">üü¢ –û–Ω–ª–∞–π–Ω</span>' : date.toLocaleString('uk-UA');

                        tbody.innerHTML += `<tr>
                            <td>${u.telegramId}</td>
                            <td>@${u.username || '–ü—Ä–∏—Ö–æ–≤–∞–Ω–æ'}</td>
                            <td class="money">${u.balance.toFixed(4)}</td>
                            <td class="energy">‚ö° ${Math.floor(u.energy)}</td>
                            <td>${u.referrals} üë•</td>
                            <td>${timeText}</td>
                        </tr>`;
                    });
                    
                    document.getElementById('updateStatus').textContent = `–û–Ω–æ–≤–ª–µ–Ω–æ: ${new Date().toLocaleTimeString('uk-UA')}`;
                })
                .catch(err => {
                    document.getElementById('updateStatus').textContent = '‚ùå –ü–æ–º–∏–ª–∫–∞ –∑\'—î–¥–Ω–∞–Ω–Ω—è (–º–æ–∂–ª–∏–≤–æ —Å–µ—Ä–≤–µ—Ä "—Å–ø–∏—Ç—å")';
                    document.getElementById('updateStatus').style.background = '#ef4444';
                });
        }

        fetchUsers();
        setInterval(fetchUsers, 10000); // –ê–≤—Ç–æ–æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–∂–Ω—ñ 10 —Å–µ–∫—É–Ω–¥
    </script>
</body>
</html>